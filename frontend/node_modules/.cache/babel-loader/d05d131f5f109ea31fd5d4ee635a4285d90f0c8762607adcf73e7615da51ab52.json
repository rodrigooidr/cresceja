{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projetos App\\\\cresceja\\\\frontend\\\\src\\\\contexts\\\\PricingContext.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useCallback, useContext, useEffect, useState } from \"react\";\nimport api from \"../api/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PricingCtx = /*#__PURE__*/createContext({\n  plans: [],\n  loading: true,\n  error: \"\",\n  refresh: () => {}\n});\nconst DEFAULT = {\n  id: \"\",\n  name: \"\",\n  monthlyPrice: 0,\n  currency: \"BRL\",\n  is_published: false,\n  sort_order: 9999,\n  is_free: false,\n  trial_days: 14,\n  billing_period_months: 1,\n  modules: {\n    omnichannel: {\n      enabled: true,\n      chat_sessions: 200\n    },\n    crm: {\n      enabled: true,\n      opportunities: 500\n    },\n    marketing: {\n      enabled: true,\n      posts_per_month: 20\n    },\n    approvals: {\n      enabled: true\n    },\n    ai_credits: {\n      enabled: true,\n      credits: 10000\n    },\n    governance: {\n      enabled: true\n    }\n  }\n};\nfunction normalize(p) {\n  var _p$modules, _p$modules2, _p$modules3, _p$modules4, _p$modules5, _p$modules6;\n  return {\n    ...DEFAULT,\n    ...p,\n    modules: {\n      ...DEFAULT.modules,\n      ...((p === null || p === void 0 ? void 0 : p.modules) || {}),\n      omnichannel: {\n        ...DEFAULT.modules.omnichannel,\n        ...((p === null || p === void 0 ? void 0 : (_p$modules = p.modules) === null || _p$modules === void 0 ? void 0 : _p$modules.omnichannel) || {})\n      },\n      crm: {\n        ...DEFAULT.modules.crm,\n        ...((p === null || p === void 0 ? void 0 : (_p$modules2 = p.modules) === null || _p$modules2 === void 0 ? void 0 : _p$modules2.crm) || {})\n      },\n      marketing: {\n        ...DEFAULT.modules.marketing,\n        ...((p === null || p === void 0 ? void 0 : (_p$modules3 = p.modules) === null || _p$modules3 === void 0 ? void 0 : _p$modules3.marketing) || {})\n      },\n      approvals: {\n        ...DEFAULT.modules.approvals,\n        ...((p === null || p === void 0 ? void 0 : (_p$modules4 = p.modules) === null || _p$modules4 === void 0 ? void 0 : _p$modules4.approvals) || {})\n      },\n      ai_credits: {\n        ...DEFAULT.modules.ai_credits,\n        ...((p === null || p === void 0 ? void 0 : (_p$modules5 = p.modules) === null || _p$modules5 === void 0 ? void 0 : _p$modules5.ai_credits) || {})\n      },\n      governance: {\n        ...DEFAULT.modules.governance,\n        ...((p === null || p === void 0 ? void 0 : (_p$modules6 = p.modules) === null || _p$modules6 === void 0 ? void 0 : _p$modules6.governance) || {})\n      }\n    }\n  };\n}\nexport function PricingProvider({\n  children\n}) {\n  _s();\n  const [plans, setPlans] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const refresh = useCallback(async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      var _res;\n      let res;\n      try {\n        res = await api.get(\"/api/public/plans\");\n      } catch {\n        res = await api.get(\"/api/admin/plans\");\n      }\n      const data = (_res = res) === null || _res === void 0 ? void 0 : _res.data;\n      const list = Array.isArray(data === null || data === void 0 ? void 0 : data.plans) ? data.plans : Array.isArray(data) ? data : [];\n      const normalized = list.map(normalize).sort((a, b) => {\n        var _a$sort_order, _b$sort_order;\n        return ((_a$sort_order = a.sort_order) !== null && _a$sort_order !== void 0 ? _a$sort_order : 9999) - ((_b$sort_order = b.sort_order) !== null && _b$sort_order !== void 0 ? _b$sort_order : 9999);\n      });\n      setPlans(normalized);\n      localStorage.setItem(\"plans_cache\", JSON.stringify({\n        ts: Date.now(),\n        list: normalized\n      }));\n    } catch (e) {\n      setError(\"Falha ao carregar planos.\");\n      const cache = localStorage.getItem(\"plans_cache\");\n      if (cache) {\n        try {\n          const {\n            list\n          } = JSON.parse(cache);\n          if (Array.isArray(list) && list.length) setPlans(list);\n        } catch {}\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  useEffect(() => {\n    const cache = localStorage.getItem(\"plans_cache\");\n    if (cache) {\n      try {\n        const {\n          ts,\n          list\n        } = JSON.parse(cache);\n        if (Array.isArray(list) && list.length) setPlans(list);\n        if (Date.now() - (ts || 0) < 5 * 60 * 1000) setLoading(false);\n      } catch {}\n    }\n    refresh();\n    const upd = () => refresh();\n    window.addEventListener(\"plans-updated\", upd);\n    window.addEventListener(\"trial-updated\", upd);\n    return () => {\n      window.removeEventListener(\"plans-updated\", upd);\n      window.removeEventListener(\"trial-updated\", upd);\n    };\n  }, [refresh]);\n  return /*#__PURE__*/_jsxDEV(PricingCtx.Provider, {\n    value: {\n      plans,\n      loading,\n      error,\n      refresh\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 5\n  }, this);\n}\n_s(PricingProvider, \"0++y44pdzZ4sDISSMrfjFWXelqk=\");\n_c = PricingProvider;\nexport const usePricing = () => {\n  _s2();\n  return useContext(PricingCtx);\n};\n_s2(usePricing, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"PricingProvider\");","map":{"version":3,"names":["React","createContext","useCallback","useContext","useEffect","useState","api","jsxDEV","_jsxDEV","PricingCtx","plans","loading","error","refresh","DEFAULT","id","name","monthlyPrice","currency","is_published","sort_order","is_free","trial_days","billing_period_months","modules","omnichannel","enabled","chat_sessions","crm","opportunities","marketing","posts_per_month","approvals","ai_credits","credits","governance","normalize","p","_p$modules","_p$modules2","_p$modules3","_p$modules4","_p$modules5","_p$modules6","PricingProvider","children","_s","setPlans","setLoading","setError","_res","res","get","data","list","Array","isArray","normalized","map","sort","a","b","_a$sort_order","_b$sort_order","localStorage","setItem","JSON","stringify","ts","Date","now","e","cache","getItem","parse","length","upd","window","addEventListener","removeEventListener","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","usePricing","_s2","$RefreshReg$"],"sources":["C:/Projetos App/cresceja/frontend/src/contexts/PricingContext.jsx"],"sourcesContent":["import React, { createContext, useCallback, useContext, useEffect, useState } from \"react\";\r\nimport api from \"../api/api\";\r\n\r\nconst PricingCtx = createContext({\r\n  plans: [], loading: true, error: \"\", refresh: ()=>{}\r\n});\r\n\r\nconst DEFAULT = {\r\n  id: \"\",\r\n  name: \"\",\r\n  monthlyPrice: 0,\r\n  currency: \"BRL\",\r\n  is_published: false,\r\n  sort_order: 9999,\r\n  is_free: false,\r\n  trial_days: 14,\r\n  billing_period_months: 1,\r\n  modules: {\r\n    omnichannel: { enabled: true, chat_sessions: 200 },\r\n    crm: { enabled: true, opportunities: 500 },\r\n    marketing: { enabled: true, posts_per_month: 20 },\r\n    approvals: { enabled: true },\r\n    ai_credits: { enabled: true, credits: 10000 },\r\n    governance: { enabled: true },\r\n  },\r\n};\r\n\r\nfunction normalize(p){\r\n  return {\r\n    ...DEFAULT,\r\n    ...p,\r\n    modules: {\r\n      ...DEFAULT.modules,\r\n      ...(p?.modules || {}),\r\n      omnichannel: { ...DEFAULT.modules.omnichannel, ...(p?.modules?.omnichannel || {}) },\r\n      crm: { ...DEFAULT.modules.crm, ...(p?.modules?.crm || {}) },\r\n      marketing: { ...DEFAULT.modules.marketing, ...(p?.modules?.marketing || {}) },\r\n      approvals: { ...DEFAULT.modules.approvals, ...(p?.modules?.approvals || {}) },\r\n      ai_credits: { ...DEFAULT.modules.ai_credits, ...(p?.modules?.ai_credits || {}) },\r\n      governance: { ...DEFAULT.modules.governance, ...(p?.modules?.governance || {}) },\r\n    },\r\n  };\r\n}\r\n\r\nexport function PricingProvider({ children }){\r\n  const [plans, setPlans] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const refresh = useCallback(async ()=>{\r\n    setLoading(true);\r\n    setError(\"\");\r\n    try {\r\n      let res;\r\n      try { res = await api.get(\"/api/public/plans\"); }\r\n      catch { res = await api.get(\"/api/admin/plans\"); }\r\n      const data = res?.data;\r\n      const list = Array.isArray(data?.plans) ? data.plans : Array.isArray(data) ? data : [];\r\n      const normalized = list.map(normalize).sort((a,b)=> (a.sort_order ?? 9999)-(b.sort_order ?? 9999));\r\n      setPlans(normalized);\r\n      localStorage.setItem(\"plans_cache\", JSON.stringify({ ts: Date.now(), list: normalized }));\r\n    } catch (e) {\r\n      setError(\"Falha ao carregar planos.\");\r\n      const cache = localStorage.getItem(\"plans_cache\");\r\n      if (cache) {\r\n        try { const { list } = JSON.parse(cache); if (Array.isArray(list) && list.length) setPlans(list); } catch {}\r\n      }\r\n    } finally { setLoading(false); }\r\n  },[]);\r\n\r\n  useEffect(()=>{\r\n    const cache = localStorage.getItem(\"plans_cache\");\r\n    if (cache) {\r\n      try {\r\n        const { ts, list } = JSON.parse(cache);\r\n        if (Array.isArray(list) && list.length) setPlans(list);\r\n        if (Date.now() - (ts || 0) < 5*60*1000) setLoading(false);\r\n      } catch {}\r\n    }\r\n    refresh();\r\n\r\n    const upd = ()=> refresh();\r\n    window.addEventListener(\"plans-updated\", upd);\r\n    window.addEventListener(\"trial-updated\", upd);\r\n    return ()=>{\r\n      window.removeEventListener(\"plans-updated\", upd);\r\n      window.removeEventListener(\"trial-updated\", upd);\r\n    };\r\n  }, [refresh]);\r\n\r\n  return (\r\n    <PricingCtx.Provider value={{ plans, loading, error, refresh }}>\r\n      {children}\r\n    </PricingCtx.Provider>\r\n  );\r\n}\r\n\r\nexport const usePricing = ()=> useContext(PricingCtx);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}