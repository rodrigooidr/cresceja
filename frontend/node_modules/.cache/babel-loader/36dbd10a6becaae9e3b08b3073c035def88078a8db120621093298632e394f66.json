{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projetos App\\\\cresceja\\\\frontend\\\\src\\\\pages\\\\Auth\\\\LoginPage.jsx\",\n  _s = $RefreshSig$();\n// src/pages/Auth/LoginPage.jsx\nimport React, { useState } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport api from \"../../api/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function LoginPage() {\n  _s();\n  var _location$state, _location$state$from;\n  const navigate = useNavigate();\n  const location = useLocation();\n  const from = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : (_location$state$from = _location$state.from) === null || _location$state$from === void 0 ? void 0 : _location$state$from.pathname) || \"/crm/oportunidades\";\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [erro, setErro] = useState(\"\");\n  async function handleSubmit(e) {\n    e.preventDefault();\n    setErro(\"\");\n    setLoading(true);\n    try {\n      const {\n        data\n      } = await api.post(\"/api/auth/login\", {\n        email,\n        password\n      });\n      const {\n        token,\n        user\n      } = data || {};\n      if (!token) throw new Error(\"Falha no login: token ausente.\");\n\n      // guarda o token e prepara axios\n      localStorage.setItem(\"token\", token);\n      api.defaults.headers.common.Authorization = `Bearer ${token}`;\n\n      // se o backend não mandar 'user', tenta buscar em /api/auth/me (opcional)\n      let me = user || null;\n      if (!me) {\n        try {\n          const r = await api.get(\"/api/auth/me\");\n          me = r.data;\n        } catch {\n          /* ok se não existir */\n        }\n      }\n      if (me) localStorage.setItem(\"user\", JSON.stringify(me));\n      navigate(from, {\n        replace: true\n      });\n    } catch (err) {\n      var _err$response, _err$response$data, _err$response2, _err$response2$data;\n      const msg = (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || (err === null || err === void 0 ? void 0 : (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.error) || (err === null || err === void 0 ? void 0 : err.message) || \"Não foi possível entrar.\";\n      setErro(msg);\n    } finally {\n      setLoading(false);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex items-center justify-center min-h-screen bg-gray-50\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full max-w-sm bg-white p-6 rounded shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-xl font-bold mb-4\",\n        children: \"Entrar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this), erro && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-50 text-red-700 text-sm p-3 rounded mb-3\",\n        children: erro\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"space-y-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm mb-1\",\n            children: \"E-mail\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"email\",\n            className: \"border p-2 rounded w-full\",\n            value: email,\n            onChange: e => setEmail(e.target.value),\n            autoComplete: \"email\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm mb-1\",\n            children: \"Senha\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            className: \"border p-2 rounded w-full\",\n            value: password,\n            onChange: e => setPassword(e.target.value),\n            autoComplete: \"current-password\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"w-full bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60\",\n          disabled: loading,\n          children: loading ? \"Entrando…\" : \"Entrar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n}\n_s(LoginPage, \"93lLYsYGAPIGHE4iBDCHmb4602Y=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = LoginPage;\nvar _c;\n$RefreshReg$(_c, \"LoginPage\");","map":{"version":3,"names":["React","useState","useNavigate","useLocation","api","jsxDEV","_jsxDEV","LoginPage","_s","_location$state","_location$state$from","navigate","location","from","state","pathname","email","setEmail","password","setPassword","loading","setLoading","erro","setErro","handleSubmit","e","preventDefault","data","post","token","user","Error","localStorage","setItem","defaults","headers","common","Authorization","me","r","get","JSON","stringify","replace","err","_err$response","_err$response$data","_err$response2","_err$response2$data","msg","response","message","error","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","value","onChange","target","autoComplete","required","disabled","_c","$RefreshReg$"],"sources":["C:/Projetos App/cresceja/frontend/src/pages/Auth/LoginPage.jsx"],"sourcesContent":["// src/pages/Auth/LoginPage.jsx\nimport React, { useState } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport api from \"../../api/api\";\n\nexport default function LoginPage() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const from = location.state?.from?.pathname || \"/crm/oportunidades\";\n\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [erro, setErro] = useState(\"\");\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    setErro(\"\");\n    setLoading(true);\n    try {\n      const { data } = await api.post(\"/api/auth/login\", { email, password });\n      const { token, user } = data || {};\n      if (!token) throw new Error(\"Falha no login: token ausente.\");\n\n      // guarda o token e prepara axios\n      localStorage.setItem(\"token\", token);\n      api.defaults.headers.common.Authorization = `Bearer ${token}`;\n\n      // se o backend não mandar 'user', tenta buscar em /api/auth/me (opcional)\n      let me = user || null;\n      if (!me) {\n        try {\n          const r = await api.get(\"/api/auth/me\");\n          me = r.data;\n        } catch {\n          /* ok se não existir */\n        }\n      }\n      if (me) localStorage.setItem(\"user\", JSON.stringify(me));\n\n      navigate(from, { replace: true });\n    } catch (err) {\n      const msg =\n        err?.response?.data?.message ||\n        err?.response?.data?.error ||\n        err?.message ||\n        \"Não foi possível entrar.\";\n      setErro(msg);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"flex items-center justify-center min-h-screen bg-gray-50\">\n      <div className=\"w-full max-w-sm bg-white p-6 rounded shadow\">\n        <h1 className=\"text-xl font-bold mb-4\">Entrar</h1>\n\n        {erro && (\n          <div className=\"bg-red-50 text-red-700 text-sm p-3 rounded mb-3\">\n            {erro}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-3\">\n          <div>\n            <label className=\"block text-sm mb-1\">E-mail</label>\n            <input\n              type=\"email\"\n              className=\"border p-2 rounded w-full\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              autoComplete=\"email\"\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm mb-1\">Senha</label>\n            <input\n              type=\"password\"\n              className=\"border p-2 rounded w-full\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              autoComplete=\"current-password\"\n              required\n            />\n          </div>\n\n          <button\n            type=\"submit\"\n            className=\"w-full bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60\"\n            disabled={loading}\n          >\n            {loading ? \"Entrando…\" : \"Entrar\"}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}