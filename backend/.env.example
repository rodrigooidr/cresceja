# ===== Core =====
NODE_ENV=development
PORT=4000
BASE_URL=http://localhost:4000
FRONTEND_URL=http://localhost:3000
CORS_ORIGINS=http://localhost:3000
CORS_ORIGIN=http://localhost:3000

# ===== Auth =====
JWT_SECRET=dev-change-me
JWT_TEST_SECRET=dev
SSE_TOKEN_SECRET=change-me

# ===== Database =====
DATABASE_URL=postgres://cresceja:cresceja123@localhost:5432/cresceja_db

# ===== Redis (opcional) =====
REDIS_URL=redis://localhost:6379

# ===== Storage =====
FILE_STORAGE=local
UPLOAD_DIR=./uploads
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=
S3_BUCKET=
S3_REGION=

# ===== E-mail (SMTP) =====
SMTP_HOST=
SMTP_PORT=
SMTP_USER=
SMTP_PASS=
EMAIL_FROM=

# ===== Billing / Pagamentos =====
# Ative modo dev para funcionar SEM chaves de provedor: retorna URL de sucesso fake
BILLING_DEV_MODE=true
BILLING_PROVIDER=none
# Stripe (opcional)
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PRICE_ID_STARTER=
STRIPE_PRICE_ID_PRO=
STRIPE_PRICE_ID_BUSINESS=
# Mercado Pago (opcional)
MP_ACCESS_TOKEN=

# ===== Omnichannel / Social =====
# WhatsApp modo teste (restrito ao e-mail definido abaixo)
ENABLE_WHATSAPP_TEST_MODE=true
WHATSAPP_TEST_ALLOWED_EMAIL=rodrigooidr@hotmail.com

# Meta (WhatsApp Cloud API / Instagram / Facebook)
META_APP_ID=
META_APP_SECRET=
META_ACCESS_TOKEN=
META_WHATSAPP_PHONE_ID=
META_PAGE_ID=

# ===== IA / OpenAI (opcional) =====
OPENAI_API_KEY=

# ===== Socket / CORS =====
WS_ALLOWED_ORIGIN=http://localhost:3000

# ===== Logs & Segurança =====
LOG_LEVEL=info
INTEGRATIONS_AUDIT_LOG=console
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=300

# ===== LGPD =====
DATA_RETENTION_DAYS=365

# Overrides opcionais para alinhamento fino aos CHECKs
INBOX_DIR_IN=inbound
INBOX_DIR_OUT=outbound
INBOX_SENDER_IN=contact
INBOX_SENDER_OUT=agent
# Força fallback de WhatsApp (ignora providers mesmo se disponíveis)
WHATSAPP_FORCE_FALLBACK=false

# ===== Telemetria & Handoff =====
TELEMETRY_ENABLED=true
HANDOFF_AUTO_DISABLE_IA=true
HANDOFF_ALERT_SOUND_URL=/assets/alerts/handoff.mp3
# ===== Calendar =====
CALENDAR_PROVIDER=google
CALENDAR_TIMEZONE=America/Sao_Paulo
CALENDAR_SLOT_DEFAULT_MIN=30
CALENDAR_LEAD_TIME_MIN=120
CALENDAR_PRE_BUFFER_MIN=10
CALENDAR_POST_BUFFER_MIN=10
CALENDAR_SUGGESTION_COUNT=3
CALENDAR_REMINDERS_CRON_ENABLED=false
CALENDAR_REMINDERS_INTERVAL_MIN=15
REMINDERS_WHATSAPP_ENABLED=true
REMINDERS_WHATSAPP_TEMPLATE="Olá {name}, seu {summary} com {person} é {when}. Para confirmar, responda CONFIRMAR ou acesse: {link}"
REMINDERS_WHATSAPP_HOURS="24,1"
RSVP_BASE_URL=http://localhost:4000
NOSHOW_ENABLED=true
NOSHOW_GRACE_MIN=15

# === Reminders ===
# Máximo de requisições por minuto (por orgId+IP)
REMIND_RATE_LIMIT_PER_MINUTE=30
# Janela de deduplicação (minutos) para não reenviar lembretes iguais
REMIND_DEDUP_WINDOW_MIN=10

# === No-show cron ===
# Agenda da varredura automática (cron padrão: a cada 5 min)
NOSHOW_SWEEP_CRON=*/5 * * * *
# Janela de graça (minutos) para considerar no-show após o horário
NOSHOW_GRACE_MINUTES=15

# === Provedor WhatsApp ===
# Defina 'none' para simular não configurado (retorna 424)
WHATSAPP_PROVIDER=none

# ===== Integrações / Webhooks =====
# Base pública (usada p/ montar Redirect/Callback URLs)
PUBLIC_URL=http://localhost:4000

# ===== Meta / WhatsApp Cloud / Facebook / Instagram =====
# META_APP_ID=xxx
# META_APP_SECRET=xxx
# META_VERIFY_TOKEN=xxx
# WHATSAPP_VERIFY_TOKEN=xxx
# Para Webhooks (use o PUBLIC_URL como base):
# Callback (Meta):  ${PUBLIC_URL}/api/webhooks/meta
# Callback (Meta Pages): ${PUBLIC_URL}/api/webhooks/meta-pages
# Callback (Messenger): ${PUBLIC_URL}/api/webhooks/messenger
# Callback (Instagram): ${PUBLIC_URL}/api/webhooks/instagram
# WhatsApp Cloud: Phone Number ID + permanent token serão salvos criptografados na org_integrations.creds

# ===== Google Calendar =====
# GOOGLE_CLIENT_ID=xxx.apps.googleusercontent.com
# GOOGLE_CLIENT_SECRET=xxx
# Redirect URI (adicione no console do Google):
# ${PUBLIC_URL}/api/integrations/providers/google_calendar/connect/callback

# ===== WhatsApp Session (se aplicável) =====
# WA_SESSION_HOST=http://localhost:3001
# WA_SESSION_KEY=dev-key

# ===== Cripto de credenciais =====
# Usado pelo serviço #crypto p/ cifrar org_integrations.creds
CRESCEJA_ENC_KEY=base64:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# (Legado — somente leitura)
GOOGLE_TOKEN_ENC_KEY=base64:legacyxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# Alias opcionais (caso queira mapear variáveis externas)
CRED_SECRET_KEY=base64:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CRED_SECRET_IV=base64:yyyyyyyyyyyyyyyy
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GCAL_REDIRECT_URI=http://localhost:3000/api/appointments/oauth/google/callback
GCAL_ENCRYPTION_KEY=replace_with_32_bytes_hex_key
